<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Real Madrid Collaborator Portal</title>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <style>
    /* [Your existing CSS remains unchanged] */
    /* ... CSS omitted here for brevity ... */
  </style>
</head>
<body>
  <!-- [Your existing HTML content remains unchanged] -->
  <!-- ... header, container, footer, and formPopup ... -->

  <div id="toast"></div>

  <script>
    function openForm() {
      document.getElementById("formPopup").classList.add("active");
      document.body.classList.add("no-scroll");
    }

    function closeForm() {
      document.getElementById("formPopup").classList.remove("active");
      document.body.classList.remove("no-scroll");
    }

    function showToast(message, isError = false) {
      const toast = document.getElementById("toast");
      toast.style.backgroundColor = isError ? "#c0392b" : "#011a44";
      toast.textContent = message;
      toast.style.display = "block";
      setTimeout(() => {
        toast.style.display = "none";
      }, 3000);
    }

    (function () {
      emailjs.init("S1ITdMEdLhNQlAZq_");
    })();

    document.getElementById("registrationForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const form = this;
      const btn = document.getElementById("submitBtn");
      const fileInput = document.getElementById("attachment");
      const file = fileInput.files[0];

      btn.disabled = true;
      btn.value = "Submitting...";

      if (!file) {
        showToast("Please upload a file.", true);
        btn.disabled = false;
        btn.value = "Submit";
        return;
      }

      const reader = new FileReader();
      reader.onload = function () {
        const base64 = reader.result.split(",")[1];

        const templateParams = {
          full_name: form.full_name.value,
          email: form.email.value,
          nationality: form.nationality.value,
          scouting_area: form.scouting_area.value,
          certifications: form.certifications.value,
          club_affiliation: form.club_affiliation.value,
          experience: form.experience.value,
          attachment: base64,
          file_name: file.name
        };

        emailjs.send("service_awad8h9", "template_lesqw76", templateParams)
          .then(function (response) {
            showToast("Form submitted successfully!");
            form.reset();
            closeForm();
          })
          .catch(function (error) {
            showToast("Failed to submit. Please try again.", true);
            console.error("EmailJS error:", error);
          })
          .finally(() => {
            btn.disabled = false;
            btn.value = "Submit";
          });
      };

      reader.readAsDataURL(file);
    });
  </script>
</body>
</html>
